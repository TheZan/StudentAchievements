@using StudentAchievements.Infrastructure
@model IEnumerable<MessageListViewModel>
@{
    Layout = "_MessageLayout";
    ViewData["Title"] = "Сообщения";
}

<main class="content">
    <div class="container p-0">

		<h1 class="h3 mb-3">Сообщения</h1>

		<div class="card">
			<div class="row g-0">
				<div class="col-12 col-lg-5 col-xl-3 border-right">

					@foreach (var chat in Model)
					{
						<a onclick="GetMessages('@chat.Companion.Id')" class="list-group-item list-group-item-action border-0">
							@if(chat.UnreadMessageCount > 0)
							{
								<div class="badge bg-success float-right" id="@($"companion-{chat.Companion.Id}")">@chat.UnreadMessageCount</div>
							}
							else
							{
								<div style="visibility: hidden;" class="badge bg-success float-right" id="@($"companion-{chat.Companion.Id}")"></div>
							}
							<div class="d-flex align-items-start">
								<img src="data:image/jpeg;base64,@(Convert.ToBase64String(chat.Companion.Photo ?? NotFoundImageUtility.GetNotFoundImage()))"
                    				asp-append-version="true" class="rounded-circle mr-1" alt="@chat.Companion.Name" width="40" height="40">
								<div class="flex-grow-1 ml-3">
									@chat.Companion.Name
								</div>
							</div>
						</a>
					}

					<hr class="d-block d-lg-none mt-1 mb-0">
				</div>
				<div class="col-12 col-lg-7 col-xl-9" id="chat"></div>
			</div>
		</div>
	</div>
</main>